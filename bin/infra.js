#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("source-map-support/register");
const cdk = require("aws-cdk-lib");
const fp_1 = require("../utils/fp");
const config_ops_1 = require("../utils/config-ops");
const files_1 = require("../conts/files");
const context_1 = require("../constructs/context");
const mb_infra_stack_1 = require("../stacks/mb-infra-stack");
const config = (0, fp_1.pipe)(`${process.cwd()}/${files_1.FILES.INFRA_CONFIG}`, config_ops_1.checkIfConfigFileExists, config_ops_1.readConfigFile);
const cdkApp = new cdk.App();
const context = new context_1.Context(cdkApp, "mb-infra-context");
const env = {
    account: context.env.account,
    region: context.env.region,
};
const tags = {
    env: context.stage,
    managedBy: "mb-infra",
};
new mb_infra_stack_1.MbInfraStack(cdkApp, context.config.project.name, {
    env,
    tags,
    stage: context.stage,
    ...config,
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5mcmEuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmZyYS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSx1Q0FBcUM7QUFDckMsbUNBQW1DO0FBQ25DLG9DQUFtQztBQUNuQyxvREFBOEU7QUFFOUUsMENBQXVDO0FBQ3ZDLG1EQUFnRDtBQUNoRCw2REFBd0Q7QUFFeEQsTUFBTSxNQUFNLEdBQUcsSUFBQSxTQUFJLEVBQ2YsR0FBRyxPQUFPLENBQUMsR0FBRyxFQUFFLElBQUksYUFBSyxDQUFDLFlBQVksRUFBRSxFQUN4QyxvQ0FBdUIsRUFDdkIsMkJBQWMsQ0FDakIsQ0FBQztBQUVGLE1BQU0sTUFBTSxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBRTdCLE1BQU0sT0FBTyxHQUFHLElBQUksaUJBQU8sQ0FBQyxNQUFNLEVBQUUsa0JBQWtCLENBQUMsQ0FBQTtBQUN2RCxNQUFNLEdBQUcsR0FBb0I7SUFDekIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTztJQUM1QixNQUFNLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNO0NBQzdCLENBQUM7QUFDRixNQUFNLElBQUksR0FBRztJQUNULEdBQUcsRUFBRSxPQUFPLENBQUMsS0FBSztJQUNsQixTQUFTLEVBQUUsVUFBVTtDQUN4QixDQUFDO0FBQ0YsSUFBSSw2QkFBWSxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUU7SUFDbEQsR0FBRztJQUNILElBQUk7SUFDSixLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUs7SUFDcEIsR0FBRyxNQUFNO0NBQ1osQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiIyEvdXNyL2Jpbi9lbnYgbm9kZVxuaW1wb3J0IFwic291cmNlLW1hcC1zdXBwb3J0L3JlZ2lzdGVyXCI7XG5pbXBvcnQgKiBhcyBjZGsgZnJvbSBcImF3cy1jZGstbGliXCI7XG5pbXBvcnQgeyBwaXBlIH0gZnJvbSBcIi4uL3V0aWxzL2ZwXCI7XG5pbXBvcnQgeyBjaGVja0lmQ29uZmlnRmlsZUV4aXN0cywgcmVhZENvbmZpZ0ZpbGUgfSBmcm9tIFwiLi4vdXRpbHMvY29uZmlnLW9wc1wiO1xuaW1wb3J0IHsgSW5mcmFDb25maWcgfSBmcm9tIFwiLi4vc2NoZW1hcy9pbmZyYS5jb25maWdcIjtcbmltcG9ydCB7IEZJTEVTIH0gZnJvbSBcIi4uL2NvbnRzL2ZpbGVzXCI7XG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSBcIi4uL2NvbnN0cnVjdHMvY29udGV4dFwiO1xuaW1wb3J0IHsgTWJJbmZyYVN0YWNrIH0gZnJvbSBcIi4uL3N0YWNrcy9tYi1pbmZyYS1zdGFja1wiO1xuXG5jb25zdCBjb25maWcgPSBwaXBlPHN0cmluZywgSW5mcmFDb25maWc+KFxuICAgIGAke3Byb2Nlc3MuY3dkKCl9LyR7RklMRVMuSU5GUkFfQ09ORklHfWAsXG4gICAgY2hlY2tJZkNvbmZpZ0ZpbGVFeGlzdHMsXG4gICAgcmVhZENvbmZpZ0ZpbGVcbik7XG5cbmNvbnN0IGNka0FwcCA9IG5ldyBjZGsuQXBwKCk7XG5cbmNvbnN0IGNvbnRleHQgPSBuZXcgQ29udGV4dChjZGtBcHAsIFwibWItaW5mcmEtY29udGV4dFwiKVxuY29uc3QgZW52OiBjZGsuRW52aXJvbm1lbnQgPSB7XG4gICAgYWNjb3VudDogY29udGV4dC5lbnYuYWNjb3VudCxcbiAgICByZWdpb246IGNvbnRleHQuZW52LnJlZ2lvbixcbn07XG5jb25zdCB0YWdzID0ge1xuICAgIGVudjogY29udGV4dC5zdGFnZSxcbiAgICBtYW5hZ2VkQnk6IFwibWItaW5mcmFcIixcbn07XG5uZXcgTWJJbmZyYVN0YWNrKGNka0FwcCwgY29udGV4dC5jb25maWcucHJvamVjdC5uYW1lLCB7XG4gICAgZW52LFxuICAgIHRhZ3MsXG4gICAgc3RhZ2U6IGNvbnRleHQuc3RhZ2UsXG4gICAgLi4uY29uZmlnLFxufSk7XG4iXX0=